import{r as d,j as e}from"./index-Cq3cNOe4.js";import{a as m}from"./axios-Bl1vbFzL.js";import{C as V,a as X,b as R,c as r,d as Y,e as c,h as Z,E as ee}from"./jspdf.es.min-DhbDYEgH.js";import{a as h,c as f}from"./index.esm-BVbxNr3O.js";import{C as ae,a as ie}from"./CRow-CR1dTeP1.js";import{C as ne,a as oe}from"./CCardBody-BZy5Kcki.js";import{C as le}from"./CCardHeader-Drjisk7v.js";import{c as se,a as re,b as ce,d as te}from"./cil-trash-BnkbpAXr.js";import{C as S}from"./CFormInput-CPK1Hc24.js";import{C as w,a as D,b as P,c as k}from"./CModalHeader-DM5zFOOe.js";import{C as n}from"./CFormSelect-sMFcUcNb.js";import"./DefaultLayout-VGzP6Txu.js";const Ne=()=>{const[j,u]=d.useState([]),[B,H]=d.useState([]),[p,E]=d.useState(null),[_,C]=d.useState(!1),[G,v]=d.useState(!1),[L,b]=d.useState(!1),[t,F]=d.useState({}),[l,T]=d.useState({expediente:"No hay",curp:"No hay",ine:"No hay",certificado:"No hay",comDomicilio:"No hay",cartilla:"No hay",nss:"No hay",rfc:"No hay",observaciones:"",acta:"No hay",id_Personal:0}),[I,$]=d.useState("");d.useEffect(()=>{const a=async()=>{try{const i=await m.get("http://localhost:4000/expedientes");u(i.data)}catch(i){console.error("Error fetching expedientes:",i)}},o=async()=>{try{const i=await m.get("http://localhost:4000/personal/sinExpediente");H(i.data)}catch(i){console.error("Error fetching personal:",i)}};a(),o()},[]);const q=async()=>{try{const a=await m.post("http://localhost:4000/expedientes",l);u([...j,a.data]),v(!1),T({expediente:"No hay",curp:"No hay",ine:"No hay",certificado:"No hay",comDomicilio:"No hay",cartilla:"No hay",nss:"No hay",rfc:"No hay",observaciones:"",acta:"No hay",id_Personal:0})}catch(a){console.error("Error adding expediente:",a)}},U=async()=>{try{await m.delete(`http://localhost:4000/expedientes/${p}`);const a=j.filter(o=>o.idExpediente!==p);u(a),b(!1),E(null)}catch(a){console.error("Error deleting expediente:",a)}},W=a=>{const o=j.find(i=>i.idExpediente===a);F(o),E(a),C(!0)},x=a=>{const{name:o,value:i}=a.target;F({...t,[o]:i})},s=a=>{const{name:o,value:i}=a.target;T({...l,[o]:i})},z=async()=>{try{const a=await m.put(`http://localhost:4000/expedientes/${p}`,t),o=j.map(i=>i.idExpediente===p?a.data:i);u(o),C(!1)}catch(a){console.error("Error updating expediente:",a)}},J=()=>{const a=document.getElementById("table-to-pdf");Z(a,{scale:2}).then(o=>{const i=o.toDataURL("image/png"),g=new ee("p","mm","a4"),A=210,M=295,y=o.height*A/o.width;let N=y,O=0;for(g.addImage(i,"PNG",0,O,A,y),N-=M;N>=0;)O=N-y,g.addPage(),g.addImage(i,"PNG",0,O,A,y),N-=M;g.save("expedientes.pdf")})},K=a=>{$(a.target.value)},Q=j.filter(a=>a.nombre.toLowerCase().includes(I.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsx(ie,{xs:12,children:e.jsxs(ne,{className:"mb-2",children:[e.jsxs(le,{children:["Tabla Expedientes",e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex",children:[e.jsxs(h,{color:"primary",onClick:()=>v(!0),className:"me-2",children:[e.jsx(f,{icon:se})," Añadir"]}),e.jsxs(h,{color:"danger",onClick:()=>b(!0),disabled:p===null,className:"me-2",children:[e.jsx(f,{icon:re})," Eliminar"]}),e.jsxs(h,{color:"info",onClick:()=>W(p),disabled:p===null,className:"me-2",children:[e.jsx(f,{icon:ce})," Editar"]}),e.jsxs(h,{color:"success",onClick:J,children:[e.jsx(f,{icon:te})," Generar PDF"]})]}),e.jsx(S,{type:"text",placeholder:"Buscar por nombre",value:I,onChange:K,className:"w-25"})]})]}),e.jsx(oe,{children:e.jsxs(V,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(X,{className:"text-nowrap",children:e.jsxs(R,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:"Personal"}),e.jsx(r,{children:"Expediente"}),e.jsx(r,{children:"Acta"}),e.jsx(r,{children:"Curp"}),e.jsx(r,{children:"INE"}),e.jsx(r,{children:"Certificado"}),e.jsx(r,{children:"Comprobante Dom."}),e.jsx(r,{children:"Cartilla"}),e.jsx(r,{children:"NSS"}),e.jsx(r,{children:"RFC"}),e.jsx(r,{children:"Observaciones"})]})}),e.jsx(Y,{children:Q.map((a,o)=>e.jsxs(R,{onClick:()=>E(a.idExpediente),className:a.idExpediente===p?"table-active":"",children:[e.jsx(c,{children:o+1})," ",e.jsx(c,{children:a.nombre}),e.jsx(c,{children:a.expediente}),e.jsx(c,{children:a.acta}),e.jsx(c,{children:a.curp}),e.jsx(c,{children:a.ine}),e.jsx(c,{children:a.certificado}),e.jsx(c,{children:a.comDomicilio}),e.jsx(c,{children:a.cartilla}),e.jsx(c,{children:a.nss}),e.jsx(c,{children:a.rfc}),e.jsx(c,{children:a.observaciones})]},a.idExpediente))})]})})]})})}),e.jsxs(w,{visible:_,onClose:()=>C(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Editar Expediente"})}),e.jsxs(P,{children:[e.jsxs(n,{label:"Expediente",name:"expediente",value:t.expediente||"",onChange:x,children:[e.jsx("option",{value:"No hay",children:"No hay"}),e.jsx("option",{value:"Si hay",children:"Sí hay"})]}),e.jsxs(n,{label:"Curp",name:"curp",value:t.curp||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"INE",name:"ine",value:t.ine||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Certificado",name:"certificado",value:t.certificado||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Comprobante de Domicilio",name:"comDomicilio",value:t.comDomicilio||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Cartilla",name:"cartilla",value:t.cartilla||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"NSS",name:"nss",value:t.nss||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"RFC",name:"rfc",value:t.rfc||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsx(S,{label:"Observaciones",name:"observaciones",value:l.observaciones,onChange:s}),e.jsxs(n,{label:"Acta",name:"acta",value:t.acta||"",onChange:x,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]})]}),e.jsxs(k,{children:[e.jsx(h,{color:"secondary",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(h,{color:"primary",onClick:z,children:"Guardar"})]})]}),e.jsxs(w,{visible:G,onClose:()=>v(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Agregar Expediente"})}),e.jsxs(P,{children:[e.jsxs(n,{label:"Expediente",name:"expediente",value:l.expediente,onChange:s,children:[e.jsx("option",{value:"No hay",children:"No hay"}),e.jsx("option",{value:"Si hay",children:"Sí hay"})]}),e.jsxs(n,{label:"Curp",name:"curp",value:l.curp,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"INE",name:"ine",value:l.ine,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Certificado",name:"certificado",value:l.certificado,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Comprobante de Domicilio",name:"comDomicilio",value:l.comDomicilio,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Cartilla",name:"cartilla",value:l.cartilla,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"NSS",name:"nss",value:l.nss,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"RFC",name:"rfc",value:l.rfc,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsx(S,{label:"Observaciones",name:"observaciones",value:l.observaciones,onChange:s}),e.jsxs(n,{label:"Acta",name:"acta",value:l.acta,onChange:s,children:[e.jsx("option",{value:"Original",children:"Original"}),e.jsx("option",{value:"Copia",children:"Copia"}),e.jsx("option",{value:"Ambas",children:"Ambas"}),e.jsx("option",{value:"No hay",children:"No hay"})]}),e.jsxs(n,{label:"Personal",name:"id_Personal",value:l.id_Personal,onChange:s,children:[e.jsx("option",{value:0,children:"Selecciona Personal"}),B.map(a=>e.jsx("option",{value:a.id_Personal,children:a.nombre},a.id_Personal))]})]}),e.jsxs(k,{children:[e.jsx(h,{color:"secondary",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(h,{color:"primary",onClick:q,children:"Agregar"})]})]}),e.jsxs(w,{visible:L,onClose:()=>b(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Eliminar Expediente"})}),e.jsx(P,{children:e.jsx("p",{children:"¿Estás seguro de que deseas eliminar este expediente?"})}),e.jsxs(k,{children:[e.jsx(h,{color:"secondary",onClick:()=>b(!1),children:"Cancelar"}),e.jsx(h,{color:"danger",onClick:U,children:"Eliminar"})]})]})]})};export{Ne as default};
