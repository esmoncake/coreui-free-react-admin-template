import{r as t,j as e}from"./index-Cq3cNOe4.js";import{a as u}from"./axios-Bl1vbFzL.js";import{C as X,a as Y,b as P,c as F,d as Z,e as B,h as _,E as ee}from"./jspdf.es.min-DhbDYEgH.js";import{a as o,c as f}from"./index.esm-BVbxNr3O.js";import{C as ae,a as se}from"./CRow-CR1dTeP1.js";import{C as re,a as te}from"./CCardBody-BZy5Kcki.js";import{C as oe}from"./CCardHeader-Drjisk7v.js";import{c as le,a as ne,b as ce,d as de}from"./cil-trash-BnkbpAXr.js";import{C as y}from"./CFormInput-CPK1Hc24.js";import{C as A,a as E,b as N,c as v}from"./CModalHeader-DM5zFOOe.js";import{C as ie}from"./CAlert-BYmA3n6A.js";import"./DefaultLayout-VGzP6Txu.js";const Ae=()=>{const[n,c]=t.useState([]),[l,g]=t.useState(null),[G,d]=t.useState(!1),[H,i]=t.useState(!1),[L,h]=t.useState(!1),[m,S]=t.useState({}),[x,R]=t.useState({area:""}),[D,q]=t.useState(""),[T,k]=t.useState([]);t.useEffect(()=>{(async()=>{try{const s=await u.get("http://localhost:4000/areas");c(s.data)}catch(s){console.error("Error fetching areas:",s)}})()},[]);const M=a=>{k([...T,{message:a}]),setTimeout(()=>{k(s=>s.slice(1))},5e3)},z=async()=>{if(!x.area.trim()){M("El nombre del área no puede estar vacío.");return}try{const a=await u.post("http://localhost:4000/areas",x);c([...n,a.data]),i(!1),R({area:""})}catch(a){console.error("Error adding area:",a)}},$=async()=>{try{await u.delete(`http://localhost:4000/areas/${l}`);const a=n.filter(s=>s.idAreas!==l);c(a),g(null),h(!1)}catch(a){console.error("Error deleting area:",a)}},U=a=>{const s=n.find(r=>r.idAreas===a);S(s),g(a),d(!0)},W=a=>{const{name:s,value:r}=a.target;S({...m,[s]:r})},J=a=>{const{name:s,value:r}=a.target;R({...x,[s]:r})},K=async()=>{if(!m.area.trim()){M("El nombre del área no puede estar vacío.");return}try{const a=await u.put(`http://localhost:4000/areas/${l}`,m),s=n.map(r=>r.idAreas===l?a.data:r);c(s),d(!1)}catch(a){console.error("Error updating area:",a)}},O=()=>{const a=document.getElementById("table-to-pdf");_(a,{scale:2}).then(s=>{const r=s.toDataURL("image/png"),C=new ee("p","mm","a4"),b=210,I=295,j=s.height*b/s.width;let p=j,w=0;for(C.addImage(r,"PNG",0,w,b,j),p-=I;p>=0;)w=p-j,C.addPage(),C.addImage(r,"PNG",0,w,b,j),p-=I;C.save("table.pdf")})},Q=a=>{q(a.target.value)},V=n.filter(a=>a.area.toLowerCase().includes(D.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx(ae,{children:e.jsx(se,{xs:12,children:e.jsxs(re,{className:"mb-2",children:[e.jsxs(oe,{children:["Tabla Áreas",e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex",children:[e.jsxs(o,{color:"primary",onClick:()=>i(!0),className:"me-2",children:[e.jsx(f,{icon:le})," Añadir"]}),e.jsxs(o,{color:"danger",onClick:()=>h(!0),disabled:l===null,className:"me-2",children:[e.jsx(f,{icon:ne})," Eliminar"]}),e.jsxs(o,{color:"info",onClick:()=>U(l),disabled:l===null,className:"me-2",children:[e.jsx(f,{icon:ce})," Editar"]}),e.jsxs(o,{color:"success",onClick:O,children:[e.jsx(f,{icon:de})," Generar PDF"]})]}),e.jsx(y,{type:"text",placeholder:"Buscar por Área",value:D,onChange:Q,className:"w-25"})]})]}),e.jsx(te,{children:e.jsxs(X,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(Y,{className:"text-nowrap",children:e.jsxs(P,{children:[e.jsx(F,{className:"bg-body-tertiary",children:"#"}),e.jsx(F,{className:"bg-body-tertiary",children:"Área"})]})}),e.jsx(Z,{children:V.map((a,s)=>e.jsxs(P,{onClick:()=>g(a.idAreas),className:a.idAreas===l?"table-active":"","data-id":a.idAreas,children:[e.jsx(B,{children:s+1}),e.jsx(B,{children:a.area})]},a.idAreas))})]})})]})})}),e.jsxs(A,{visible:H,onClose:()=>i(!1),children:[e.jsx(E,{children:e.jsx("h5",{children:"Añadir Área"})}),e.jsx(N,{children:e.jsx(y,{label:"Nombre del Área",name:"area",value:x.area,onChange:J})}),e.jsxs(v,{children:[e.jsx(o,{color:"secondary",onClick:()=>i(!1),children:"Cerrar"}),e.jsx(o,{color:"primary",onClick:z,children:"Guardar"})]})]}),e.jsxs(A,{visible:G,onClose:()=>d(!1),children:[e.jsx(E,{children:e.jsx("h5",{children:"Editar Área"})}),e.jsx(N,{children:e.jsx(y,{label:"Nombre del Área",name:"area",value:m.area||"",onChange:W})}),e.jsxs(v,{children:[e.jsx(o,{color:"secondary",onClick:()=>d(!1),children:"Cerrar"}),e.jsx(o,{color:"primary",onClick:K,children:"Guardar"})]})]}),e.jsxs(A,{visible:L,onClose:()=>h(!1),children:[e.jsx(E,{children:e.jsx("h5",{children:"Confirmar eliminación"})}),e.jsx(N,{children:"¿Estás seguro de que quieres eliminar esta área?"}),e.jsxs(v,{children:[e.jsx(o,{color:"secondary",onClick:()=>h(!1),children:"Cancelar"}),e.jsx(o,{color:"danger",onClick:$,children:"Eliminar"})]})]}),e.jsx("div",{className:"position-fixed bottom-0 start-0 p-3",style:{zIndex:1550},children:T.map((a,s)=>e.jsx(ie,{color:"danger",className:"mb-2",style:{zIndex:1560},children:a.message},s))})]})};export{Ae as default};
