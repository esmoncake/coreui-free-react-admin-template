import{r,j as e}from"./index-Cq3cNOe4.js";import{a as d}from"./axios-Bl1vbFzL.js";import{C as _,a as ee,b as q,c as h,d as ae,e as m,h as oe,E as se}from"./jspdf.es.min-DhbDYEgH.js";import{a as c,c as S}from"./index.esm-BVbxNr3O.js";import{C as re,a as ce}from"./CRow-CR1dTeP1.js";import{C as te,a as ie}from"./CCardBody-BZy5Kcki.js";import{C as le}from"./CCardHeader-Drjisk7v.js";import{c as ne,a as de,b as he,d as me}from"./cil-trash-BnkbpAXr.js";import{C as p}from"./CFormInput-CPK1Hc24.js";import{C as A,a as D,b as M,c as k}from"./CModalHeader-DM5zFOOe.js";import{C as T}from"./CFormSelect-sMFcUcNb.js";import{C as pe}from"./CAlert-BYmA3n6A.js";import"./DefaultLayout-VGzP6Txu.js";const Ee=()=>{const[n,x]=r.useState([]),[I,z]=r.useState([]),[t,N]=r.useState(null),[$,u]=r.useState(!1),[U,C]=r.useState(!1),[W,j]=r.useState(!1),[i,F]=r.useState({}),[l,L]=r.useState({tipo:"",marca:"",descripcion:"",computadora:""}),[g,J]=r.useState(""),[P,B]=r.useState([]);r.useEffect(()=>{const a=async()=>{try{const s=await d.get("http://localhost:4000/accesorios");x(s.data)}catch(s){console.error("Error fetching accesorios:",s)}};(async()=>{try{const s=await d.get("http://localhost:4000/computo");z(s.data)}catch(s){console.error("Error fetching accesorios:",s)}})(),a()},[]);const G=a=>{B([...P,{message:a}]),setTimeout(()=>{B(o=>o.slice(1))},5e3)},K=async()=>{if(!l.tipo.trim()||!l.marca.trim()){G("Todos los campos son obligatorios.");return}try{const a=await d.post("http://localhost:4000/accesorios",l);x([...n,a.data]),C(!1),L({tipo:"",marca:"",descripcion:"",computadora:""})}catch(a){console.error("Error adding accesorio:",a)}},O=async()=>{try{await d.delete(`http://localhost:4000/accesorios/${t}`);const a=n.filter(o=>o.id!==t);x(a),N(null),j(!1)}catch(a){console.error("Error deleting accesorio:",a)}},Q=a=>{const o=n.find(s=>s.id===a);F(o),N(a),u(!0)},f=a=>{const{name:o,value:s}=a.target;F({...i,[o]:s})},b=a=>{const{name:o,value:s}=a.target;L({...l,[o]:s})},V=async()=>{if(!i.tipo.trim()||!i.marca.trim()){G("Todos los campos son obligatorios.");return}try{const a=await d.put(`http://localhost:4000/accesorios/${t}`,i),o=n.map(s=>s.id===t?a.data:s);x(o),u(!1)}catch(a){console.error("Error updating accesorio:",a)}},X=()=>{const a=document.getElementById("table-to-pdf");oe(a,{scale:2}).then(o=>{const s=o.toDataURL("image/png"),v=new se("p","mm","a4"),E=210,H=295,y=o.height*E/o.width;let w=y,R=0;for(v.addImage(s,"PNG",0,R,E,y),w-=H;w>=0;)R=w-y,v.addPage(),v.addImage(s,"PNG",0,R,E,y),w-=H;v.save("accesorios.pdf")})},Y=a=>{J(a.target.value)},Z=n.filter(a=>a.tipo.toLowerCase().includes(g.toLowerCase())||a.marca.toLowerCase().includes(g.toLowerCase())||a.descripcion.toLowerCase().includes(g.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(ce,{xs:12,children:e.jsxs(te,{className:"mb-2",children:[e.jsxs(le,{children:["Tabla Accesorios",e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex",children:[e.jsxs(c,{color:"primary",onClick:()=>C(!0),className:"me-2",children:[e.jsx(S,{icon:ne})," Añadir"]}),e.jsxs(c,{color:"danger",onClick:()=>j(!0),disabled:t===null,className:"me-2",children:[e.jsx(S,{icon:de})," Eliminar"]}),e.jsxs(c,{color:"info",onClick:()=>Q(t),disabled:t===null,className:"me-2",children:[e.jsx(S,{icon:he})," Editar"]}),e.jsxs(c,{color:"success",onClick:X,children:[e.jsx(S,{icon:me})," Generar PDF"]})]}),e.jsx(p,{type:"text",placeholder:"Buscar por Tipo, Marca o Descripción",value:g,onChange:Y,className:"w-25"})]})]}),e.jsx(ie,{children:e.jsxs(_,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(ee,{className:"text-nowrap",children:e.jsxs(q,{children:[e.jsx(h,{className:"bg-body-tertiary",children:"#"}),e.jsx(h,{className:"bg-body-tertiary",children:"Tipo"}),e.jsx(h,{className:"bg-body-tertiary",children:"Marca"}),e.jsx(h,{className:"bg-body-tertiary",children:"Descripción"}),e.jsx(h,{className:"bg-body-tertiary",children:"Computadora"})]})}),e.jsx(ae,{children:Z.map((a,o)=>e.jsxs(q,{onClick:()=>N(a.id),className:a.id===t?"table-active":"","data-id":a.id,children:[e.jsx(m,{children:o+1}),e.jsx(m,{children:a.tipo}),e.jsx(m,{children:a.marca}),e.jsx(m,{children:a.descripcion}),e.jsx(m,{children:a.computadora})]},a.id))})]})})]})})}),e.jsxs(A,{visible:U,onClose:()=>C(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Añadir Accesorio"})}),e.jsxs(M,{children:[e.jsxs(T,{label:"Tipo",name:"tipo",value:l.tipo,onChange:b,children:[e.jsx("option",{value:"",children:"Seleccionar Tipo"}),e.jsx("option",{value:"Raton",children:"Raton"}),e.jsx("option",{value:"Teclado",children:"Teclado"}),e.jsx("option",{value:"Cargador",children:"Cargador"})]}),e.jsx(p,{label:"Marca",name:"marca",value:l.marca,onChange:b}),e.jsx(p,{label:"Descripción",name:"descripcion",value:l.descripcion,onChange:b}),e.jsxs(T,{label:"Computadora",name:"computadora",value:l.computadora,onChange:b,children:[e.jsx("option",{value:"",children:"Selecciona una computadora"}),I.map(a=>e.jsx("option",{value:a.id,children:a.noSerie},a.id))]})]}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>C(!1),children:"Cerrar"}),e.jsx(c,{color:"primary",onClick:K,children:"Guardar"})]})]}),e.jsxs(A,{visible:$,onClose:()=>u(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Editar Accesorio"})}),e.jsxs(M,{children:[e.jsxs(T,{label:"Tipo",name:"tipo",value:i.tipo||"",onChange:f,children:[e.jsx("option",{value:"",children:"Seleccionar Tipo"}),e.jsx("option",{value:"Raton",children:"Raton"}),e.jsx("option",{value:"Teclado",children:"Teclado"}),e.jsx("option",{value:"Cargador",children:"Cargador"})]}),e.jsx(p,{label:"Marca",name:"marca",value:i.marca||"",onChange:f}),e.jsx(p,{label:"Descripción",name:"descripcion",value:i.descripcion||"",onChange:f}),e.jsxs(T,{label:"Computadora",name:"computadora",value:i.computadora||"",onChange:f,children:[e.jsx("option",{value:"",children:"Selecciona una computadora"}),I.map(a=>e.jsx("option",{value:a.id,children:a.noSerie},a.id))]})]}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>u(!1),children:"Cerrar"}),e.jsx(c,{color:"primary",onClick:V,children:"Guardar"})]})]}),e.jsxs(A,{visible:W,onClose:()=>j(!1),children:[e.jsx(D,{children:e.jsx("h5",{children:"Confirmar eliminación"})}),e.jsx(M,{children:"¿Estás seguro de que quieres eliminar este accesorio?"}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(c,{color:"danger",onClick:O,children:"Eliminar"})]})]}),e.jsx("div",{className:"position-fixed bottom-0 start-0 p-3",style:{zIndex:1550},children:P.map((a,o)=>e.jsx(pe,{color:"danger",className:"mb-2",style:{zIndex:1560},children:a.message},o))})]})};export{Ee as default};
