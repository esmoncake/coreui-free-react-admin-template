import{r,j as e}from"./index-Cq3cNOe4.js";import{a as u}from"./axios-Bl1vbFzL.js";import{C as ee,a as ae,b as G,c as h,d as oe,e as m,h as se,E as ne}from"./jspdf.es.min-DhbDYEgH.js";import{a as c,c as y}from"./index.esm-BVbxNr3O.js";import{C as re,a as le}from"./CRow-CR1dTeP1.js";import{C as ce,a as ie}from"./CCardBody-BZy5Kcki.js";import{C as de}from"./CCardHeader-Drjisk7v.js";import{c as te,a as he,b as me,d as xe}from"./cil-trash-BnkbpAXr.js";import{C as j}from"./CFormInput-CPK1Hc24.js";import{C as M,a as A,b as D,c as k}from"./CModalHeader-DM5zFOOe.js";import{C as x}from"./CFormSelect-sMFcUcNb.js";import"./DefaultLayout-VGzP6Txu.js";const Pe=()=>{const[g,v]=r.useState([]),[T,U]=r.useState([]),[F,q]=r.useState([]),[I,V]=r.useState([]),[i,P]=r.useState(null),[$,b]=r.useState(!1),[W,f]=r.useState(!1),[z,E]=r.useState(!1),[d,B]=r.useState({}),[l,H]=r.useState({marca:"",modelo:"",noSerie:"",ubicacion:0,encargado:0,estado:"",idProveedor:0}),[R,J]=r.useState("");r.useEffect(()=>{const a=async()=>{try{const o=await u.get("http://localhost:4000/radios");v(o.data)}catch(o){console.error("Error fetching Radios:",o)}},s=async()=>{try{const o=await u.get("http://localhost:4000/areas");U(o.data)}catch(o){console.error("Error fetching areas:",o)}},n=async()=>{try{const o=await u.get("http://localhost:4000/proveedores");q(o.data)}catch(o){console.error("Error fetching provedores:",o)}},C=async()=>{try{const o=await u.get("http://localhost:4000/personal");V(o.data)}catch(o){console.error("Error fetching encargados:",o)}};a(),s(),n(),C()},[]);const K=async()=>{try{const a=await u.post("http://localhost:4000/radios",l);v([...g,a.data]),f(!1),H({marca:"",modelo:"",noSerie:"",ubicacion:0,encargado:0,estado:"",idProveedor:0})}catch(a){console.error("Error adding radio:",a)}},O=async()=>{try{await u.delete(`http://localhost:4000/radios/${i}`);const a=g.filter(s=>s.id!==i);v(a),P(null),E(!1)}catch(a){console.error("Error deleting radio:",a)}},Q=a=>{const s=g.find(n=>n.id===a);B(s),P(a),b(!0)},p=a=>{const{name:s,value:n}=a.target;B({...d,[s]:n})},t=a=>{const{name:s,value:n}=a.target;H({...l,[s]:n})},X=async()=>{try{const a=await u.put(`http://localhost:4000/radios/${i}`,d),s=g.map(n=>n.id===i?a.data:n);v(s),b(!1)}catch(a){console.error("Error updating radio:",a)}},Y=()=>{const a=document.getElementById("table-to-pdf");se(a,{scale:2}).then(s=>{const n=s.toDataURL("image/png"),C=new ne("p","mm","a4"),o=210,L=295,S=s.height*o/s.width;let w=S,N=0;for(C.addImage(n,"PNG",0,N,o,S),w-=L;w>=0;)N=w-S,C.addPage(),C.addImage(n,"PNG",0,N,o,S),w-=L;C.save("Radios.pdf")})},Z=a=>{J(a.target.value)},_=g.filter(a=>a.marca.toLowerCase().includes(R.toLowerCase())||a.modelo.toLowerCase().includes(R.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(le,{xs:12,children:e.jsxs(ce,{className:"mb-2",children:[e.jsxs(de,{children:["Tabla Radios",e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex",children:[e.jsxs(c,{color:"primary",onClick:()=>f(!0),className:"me-2",children:[e.jsx(y,{icon:te})," Añadir"]}),e.jsxs(c,{color:"danger",onClick:()=>E(!0),disabled:i===null,className:"me-2",children:[e.jsx(y,{icon:he})," Eliminar"]}),e.jsxs(c,{color:"info",onClick:()=>Q(i),disabled:i===null,className:"me-2",children:[e.jsx(y,{icon:me})," Editar"]}),e.jsxs(c,{color:"success",onClick:Y,children:[e.jsx(y,{icon:xe})," Generar PDF"]})]}),e.jsx(j,{type:"text",placeholder:"Buscar por marca o modelo",value:R,onChange:Z,className:"w-25"})]})]}),e.jsx(ie,{children:e.jsxs(ee,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(ae,{className:"text-nowrap",children:e.jsxs(G,{children:[e.jsx(h,{children:"#"}),e.jsx(h,{children:"Marca"}),e.jsx(h,{children:"Modelo"}),e.jsx(h,{children:"No. Serie"}),e.jsx(h,{children:"Ubicación"}),e.jsx(h,{children:"Encargado"}),e.jsx(h,{children:"Estado"}),e.jsx(h,{children:"Proveedor"})]})}),e.jsx(oe,{children:_.map((a,s)=>e.jsxs(G,{onClick:()=>P(a.id),className:a.id===i?"table-active":"",children:[e.jsx(m,{children:s+1}),e.jsx(m,{children:a.marca}),e.jsx(m,{children:a.modelo}),e.jsx(m,{children:a.noSerie}),e.jsx(m,{children:a.ubicacion}),e.jsx(m,{children:a.encargado}),e.jsx(m,{children:a.estado}),e.jsx(m,{children:a.idProveedor})]},a.id))})]})})]})})}),e.jsxs(M,{visible:W,onClose:()=>f(!1),children:[e.jsx(A,{children:e.jsx("h5",{children:"Añadir Radio"})}),e.jsxs(D,{children:[e.jsx(j,{label:"Marca",name:"marca",value:l.marca,onChange:t}),e.jsx(j,{label:"Modelo",name:"modelo",value:l.modelo,onChange:t}),e.jsx(j,{label:"No. Serie",name:"noSerie",value:l.noSerie,onChange:t}),e.jsx(x,{label:"Ubicación",name:"ubicacion",value:l.ubicacion,onChange:t,children:T.map(a=>e.jsx("option",{value:a.idAreas,children:a.area},a.idAreas))}),e.jsxs(x,{label:"Encargado",name:"encargado",value:l.encargado||"",onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un Encargado Valido"}),I.map(a=>e.jsx("option",{value:a.idPersonal,children:a.nombre},a.idPersonal))]}),e.jsxs(x,{label:"Estado",name:"estado",value:l.estado||"",onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un estado"}),e.jsx("option",{value:"Nuevo",children:"Nuevo"}),e.jsx("option",{value:"En buenas condiciones",children:"En buenas condiciones"}),e.jsx("option",{value:"Necesita reparacion",children:"Necesita Reparación"})]}),e.jsxs(x,{label:"Proveedor",name:"idProveedor",value:l.idProveedor,onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un Provedor"}),F.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]})]}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>f(!1),children:"Cancelar"}),e.jsx(c,{color:"primary",onClick:K,children:"Añadir"})]})]}),e.jsxs(M,{visible:$,onClose:()=>b(!1),children:[e.jsx(A,{children:e.jsx("h5",{children:"Editar Radio"})}),e.jsxs(D,{children:[e.jsx(j,{label:"Marca",name:"marca",value:d.marca,onChange:p}),e.jsx(j,{label:"Modelo",name:"modelo",value:d.modelo,onChange:p}),e.jsx(j,{label:"No. Serie",name:"noSerie",value:d.noSerie,onChange:p}),e.jsx(x,{label:"Ubicación",name:"ubicacion",value:d.ubicacion,onChange:p,children:T.map(a=>e.jsx("option",{value:a.idAreas,children:a.area},a.idAreas))}),e.jsxs(x,{label:"Encargado",name:"encargado",value:l.encargado||"",onChange:t,children:[e.jsx("option",{value:"",children:"Seleccione un Encargado Valido"}),I.map(a=>e.jsx("option",{value:a.idPersonal,children:a.nombre},a.idPersonal))]}),e.jsxs(x,{label:"Estado",name:"estado",value:d.estado||"",onChange:p,children:[e.jsx("option",{value:"",children:"Seleccione un estado"}),e.jsx("option",{value:"Nuevo",children:"Nuevo"}),e.jsx("option",{value:"En buenas condiciones",children:"En buenas condiciones"}),e.jsx("option",{value:"Necesita reparacion",children:"Necesita Reparación"})]}),e.jsxs(x,{label:"Proveedor",name:"idProveedor",value:d.idProveedor,onChange:p,children:[e.jsx("option",{value:"",children:"Seleccione un Provedor"}),F.map(a=>e.jsx("option",{value:a.id,children:a.nombre},a.id))]})]}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>b(!1),children:"Cancelar"}),e.jsx(c,{color:"primary",onClick:X,children:"Guardar"})]})]}),e.jsxs(M,{visible:z,onClose:()=>E(!1),children:[e.jsx(A,{children:e.jsx("h5",{children:"Eliminar Radio"})}),e.jsx(D,{children:e.jsx("p",{children:"¿Estás seguro de que quieres eliminar este radio?"})}),e.jsxs(k,{children:[e.jsx(c,{color:"secondary",onClick:()=>E(!1),children:"Cancelar"}),e.jsx(c,{color:"danger",onClick:O,children:"Eliminar"})]})]})]})};export{Pe as default};
