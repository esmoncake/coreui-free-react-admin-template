import{r,j as e}from"./index-Cq3cNOe4.js";import{a as v}from"./axios-Bl1vbFzL.js";import{C as ee,a as oe,b as O,c as x,d as ae,e as m,h as se,E as le}from"./jspdf.es.min-DhbDYEgH.js";import{a as i,c as T}from"./index.esm-BVbxNr3O.js";import{C as re,a as ie}from"./CRow-CR1dTeP1.js";import{C as ne,a as te}from"./CCardBody-BZy5Kcki.js";import{C as ce}from"./CCardHeader-Drjisk7v.js";import{c as de,a as he,b as pe,d as xe}from"./cil-trash-BnkbpAXr.js";import{C as p,a as n}from"./CFormInput-CPK1Hc24.js";import{C as F,a as P,b as R,c as I}from"./CModalHeader-DM5zFOOe.js";import{C as M}from"./CFormSelect-sMFcUcNb.js";import"./DefaultLayout-VGzP6Txu.js";const Te=()=>{const[u,E]=r.useState([]),[L,$]=r.useState([]),[t,D]=r.useState(null),[q,j]=r.useState(!1),[W,C]=r.useState(!1),[z,f]=r.useState(!1),[c,B]=r.useState({}),[d,H]=r.useState({estado:"",ubicacion:0,color:"",tamano:"",tipo:""}),[s,y]=r.useState({}),[k,J]=r.useState("");r.useEffect(()=>{const o=async()=>{try{const l=await v.get("http://localhost:4000/electronicos");E(l.data)}catch(l){console.error("Error fetching Electronicos:",l)}},a=async()=>{try{const l=await v.get("http://localhost:4000/areas");$(l.data)}catch(l){console.error("Error fetching areas:",l)}};o(),a()},[]);const G=o=>{const a={};return o.estado||(a.estado="El estado es obligatorio"),o.ubicacion||(a.ubicacion="La ubicación es obligatoria"),o.color||(a.color="El color es obligatorio"),o.tamano||(a.tamano="El tamaño es obligatorio"),o.tipo||(a.tipo="El tipo es obligatorio"),a},K=async()=>{const o=G(d);if(Object.keys(o).length>0){y(o);return}try{const a=await v.post("http://localhost:4000/electronicos",d);E([...u,a.data]),C(!1),H({estado:"",ubicacion:0,color:"",tamano:"",tipo:""}),y({})}catch(a){console.error("Error adding electronico:",a)}},Q=async()=>{try{await v.delete(`http://localhost:4000/electronicos/${t}`);const o=u.filter(a=>a.id!==t);E(o),D(null),f(!1)}catch(o){console.error("Error deleting electronico:",o)}},V=o=>{const a=u.find(l=>l.id===o);B(a),D(o),j(!0)},b=o=>{const{name:a,value:l}=o.target;B({...c,[a]:l})},g=o=>{const{name:a,value:l}=o.target;H({...d,[a]:l})},X=async()=>{const o=G(c);if(Object.keys(o).length>0){y(o);return}try{const a=await v.put(`http://localhost:4000/electronicos/${t}`,c),l=u.map(h=>h.id===t?a.data:h);E(l),j(!1),y({})}catch(a){console.error("Error updating electronico:",a)}},Y=()=>{const o=document.getElementById("table-to-pdf");se(o,{scale:2}).then(a=>{const l=a.toDataURL("image/png"),h=new le("p","mm","a4"),N=210,U=295,w=a.height*N/a.width;let S=w,A=0;for(h.addImage(l,"PNG",0,A,N,w),S-=U;S>=0;)A=S-w,h.addPage(),h.addImage(l,"PNG",0,A,N,w),S-=U;h.save("Electronicos.pdf")})},Z=o=>{J(o.target.value)},_=u.filter(o=>o.color.toLowerCase().includes(k.toLowerCase())||o.tipo.toLowerCase().includes(k.toLowerCase()));return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(ie,{xs:12,children:e.jsxs(ne,{className:"mb-2",children:[e.jsxs(ce,{children:["Tabla Electronicos",e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex",children:[e.jsxs(i,{color:"primary",onClick:()=>C(!0),className:"me-2",children:[e.jsx(T,{icon:de})," Añadir"]}),e.jsxs(i,{color:"danger",onClick:()=>f(!0),disabled:t===null,className:"me-2",children:[e.jsx(T,{icon:he})," Eliminar"]}),e.jsxs(i,{color:"info",onClick:()=>V(t),disabled:t===null,className:"me-2",children:[e.jsx(T,{icon:pe})," Editar"]}),e.jsxs(i,{color:"success",onClick:Y,children:[e.jsx(T,{icon:xe})," Generar PDF"]})]}),e.jsx(p,{type:"text",placeholder:"Buscar por color o tipo",value:k,onChange:Z,className:"w-25"})]})]}),e.jsx(te,{children:e.jsxs(ee,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[e.jsx(oe,{className:"text-nowrap",children:e.jsxs(O,{children:[e.jsx(x,{children:"#"}),e.jsx(x,{children:"Estado"}),e.jsx(x,{children:"Ubicación"}),e.jsx(x,{children:"Color"}),e.jsx(x,{children:"Tamaño"}),e.jsx(x,{children:"Tipo"})]})}),e.jsx(ae,{children:_.map((o,a)=>e.jsxs(O,{onClick:()=>D(o.id),className:o.id===t?"table-active":"",children:[e.jsx(m,{children:a+1}),e.jsx(m,{children:o.estado}),e.jsx(m,{children:o.ubicacion}),e.jsx(m,{children:o.color}),e.jsx(m,{children:o.tamano}),e.jsx(m,{children:o.tipo})]},o.id))})]})})]})})}),e.jsxs(F,{visible:W,onClose:()=>C(!1),children:[e.jsx(P,{onClose:()=>C(!1),children:"Añadir Electrónico"}),e.jsxs(R,{children:[e.jsx(p,{type:"text",label:"Estado",name:"estado",value:d.estado,onChange:g,invalid:!!s.estado}),e.jsx(n,{children:s.estado}),e.jsxs(M,{label:"Ubicación",name:"ubicacion",value:d.ubicacion,onChange:g,invalid:!!s.ubicacion,children:[e.jsx("option",{value:0,children:"Selecciona una ubicación"}),L.map(o=>e.jsx("option",{value:o.idAreas,children:o.area},o.idAreas))]}),e.jsx(n,{children:s.ubicacion}),e.jsx(p,{type:"text",label:"Color",name:"color",value:d.color,onChange:g,invalid:!!s.color}),e.jsx(n,{children:s.color}),e.jsx(p,{type:"text",label:"Tamaño",name:"tamano",value:d.tamano,onChange:g,invalid:!!s.tamano}),e.jsx(n,{children:s.tamano}),e.jsxs(M,{label:"Tipo",name:"tipo",value:d.tipo,onChange:g,invalid:!!s.tipo,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"Cafeteras",children:"Cafeteras"}),e.jsx("option",{value:"Microondas",children:"Microondas"}),e.jsx("option",{value:"Refrigerador",children:"Refrigerador"}),e.jsx("option",{value:"Dispensador",children:"Dispensador"}),e.jsx("option",{value:"Microscopio",children:"Microscopio"}),e.jsx("option",{value:"Telescopio",children:"Telescopio"})]}),e.jsx(n,{children:s.tipo})]}),e.jsxs(I,{children:[e.jsx(i,{color:"secondary",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(i,{color:"primary",onClick:K,children:"Añadir"})]})]}),e.jsxs(F,{visible:q,onClose:()=>j(!1),children:[e.jsx(P,{onClose:()=>j(!1),children:"Editar Electrónico"}),e.jsxs(R,{children:[e.jsx(p,{type:"text",label:"Estado",name:"estado",value:c.estado||"",onChange:b,invalid:!!s.estado}),e.jsx(n,{children:s.estado}),e.jsxs(M,{label:"Ubicación",name:"ubicacion",value:c.ubicacion||0,onChange:b,invalid:!!s.ubicacion,children:[e.jsx("option",{value:0,children:"Selecciona una ubicación"}),L.map(o=>e.jsx("option",{value:o.idAreas,children:o.area},o.idAreas))]}),e.jsx(n,{children:s.ubicacion}),e.jsx(p,{type:"text",label:"Color",name:"color",value:c.color||"",onChange:b,invalid:!!s.color}),e.jsx(n,{children:s.color}),e.jsx(p,{type:"text",label:"Tamaño",name:"tamano",value:c.tamano||"",onChange:b,invalid:!!s.tamano}),e.jsx(n,{children:s.tamano}),e.jsxs(M,{label:"Tipo",name:"tipo",value:c.tipo||"",onChange:b,invalid:!!s.tipo,children:[e.jsx("option",{value:"",children:"Selecciona un tipo"}),e.jsx("option",{value:"Cafeteras",children:"Cafeteras"}),e.jsx("option",{value:"Microondas",children:"Microondas"}),e.jsx("option",{value:"Refrigerador",children:"Refrigerador"}),e.jsx("option",{value:"Dispensador",children:"Dispensador"}),e.jsx("option",{value:"Microscopio",children:"Microscopio"}),e.jsx("option",{value:"Telescopio",children:"Telescopio"})]}),e.jsx(n,{children:s.tipo})]}),e.jsxs(I,{children:[e.jsx(i,{color:"secondary",onClick:()=>j(!1),children:"Cancelar"}),e.jsx(i,{color:"primary",onClick:X,children:"Guardar Cambios"})]})]}),e.jsxs(F,{visible:z,onClose:()=>f(!1),children:[e.jsx(P,{onClose:()=>f(!1),children:"Eliminar Electrónico"}),e.jsx(R,{children:"¿Estás seguro que deseas eliminar este electrónico?"}),e.jsxs(I,{children:[e.jsx(i,{color:"secondary",onClick:()=>f(!1),children:"Cancelar"}),e.jsx(i,{color:"danger",onClick:Q,children:"Eliminar"})]})]})]})};export{Te as default};
