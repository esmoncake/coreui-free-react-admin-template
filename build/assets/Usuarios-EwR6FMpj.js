import{r as i,j as s}from"./index-Cq3cNOe4.js";import{a as C}from"./axios-Bl1vbFzL.js";import{C as W,a as q,b as T,c as R,d as z,e as S,h as J,E as K}from"./jspdf.es.min-DhbDYEgH.js";import{a as r,c as j}from"./index.esm-BVbxNr3O.js";import{C as O,a as Q}from"./CRow-CR1dTeP1.js";import{C as V,a as X}from"./CCardBody-BZy5Kcki.js";import{C as Y}from"./CCardHeader-Drjisk7v.js";import{c as Z,a as _,b as ss,d as as}from"./cil-trash-BnkbpAXr.js";import{C as D,a as k,b as A,c as F}from"./CModalHeader-DM5zFOOe.js";import{C as f}from"./CFormInput-CPK1Hc24.js";import{C as M}from"./CFormSelect-sMFcUcNb.js";import"./DefaultLayout-VGzP6Txu.js";const ps=()=>{const[n,c]=i.useState([]),[t,g]=i.useState(null),[P,h]=i.useState(!1),[I,u]=i.useState(!1),[l,v]=i.useState({}),[d,U]=i.useState({usuario:"",password:"",tipo:""});i.useEffect(()=>{(async()=>{try{const e=await C.get("http://localhost:4000/usuarios");c(e.data)}catch(e){console.error("Error fetching usuarios:",e)}})()},[]);const G=async()=>{try{const a=await C.post("http://localhost:4000/usuarios",d);c([...n,a.data]),u(!1),U({usuario:"",password:"",tipo:""})}catch(a){console.error("Error adding usuario:",a)}},H=async a=>{try{await C.delete(`http://localhost:4000/usuarios/${a}`);const e=n.filter(o=>o.idUsuario!==a);c(e),g(null)}catch(e){console.error("Error deleting usuario:",e)}},B=a=>{const e=n.find(o=>o.idUsuario===a);v(e),g(a),h(!0)},b=a=>{const{name:e,value:o}=a.target;v({...l,[e]:o})},w=a=>{const{name:e,value:o}=a.target;U({...d,[e]:o})},L=async()=>{try{const a=await C.put(`http://localhost:4000/usuarios/${t}`,l),e=n.map(o=>o.idUsuario===t?a.data:o);c(e),h(!1)}catch(a){console.error("Error updating usuario:",a)}},$=()=>{const a=document.getElementById("table-to-pdf");J(a,{scale:2}).then(e=>{const o=e.toDataURL("image/png"),m=new K("p","mm","a4"),y=210,N=295,p=e.height*y/e.width;let x=p,E=0;for(m.addImage(o,"PNG",0,E,y,p),x-=N;x>=0;)E=x-p,m.addPage(),m.addImage(o,"PNG",0,E,y,p),x-=N;m.save("table.pdf")})};return s.jsxs(s.Fragment,{children:[s.jsx(O,{children:s.jsx(Q,{xs:12,children:s.jsxs(V,{className:"mb-2",children:[s.jsxs(Y,{children:["Tabla Usuarios",s.jsxs("div",{className:"d-flex justify-content-end",children:[s.jsxs(r,{color:"primary",onClick:()=>u(!0),className:"me-2",children:[s.jsx(j,{icon:Z})," A単adir"]}),s.jsxs(r,{color:"danger",onClick:()=>H(t),disabled:t===null,className:"me-2",children:[s.jsx(j,{icon:_})," Eliminar"]}),s.jsxs(r,{color:"info",onClick:()=>B(t),disabled:t===null,className:"me-2",children:[s.jsx(j,{icon:ss})," Editar"]}),s.jsxs(r,{color:"success",onClick:$,children:[s.jsx(j,{icon:as})," Generar PDF"]})]})]}),s.jsx(X,{children:s.jsxs(W,{id:"table-to-pdf",align:"middle",className:"mb-0 border",hover:!0,responsive:!0,children:[s.jsx(q,{className:"text-nowrap",children:s.jsxs(T,{children:[s.jsx(R,{className:"bg-body-tertiary",children:"Usuario"}),s.jsx(R,{className:"bg-body-tertiary",children:"Tipo"})]})}),s.jsx(z,{children:n.map(a=>s.jsxs(T,{onClick:()=>g(a.idUsuario),className:a.idUsuario===t?"table-active":"",children:[s.jsx(S,{children:a.usuario}),s.jsx(S,{children:a.tipo})]},a.idUsuario))})]})})]})})}),s.jsxs(D,{visible:I,onClose:()=>u(!1),children:[s.jsx(k,{children:s.jsx("h5",{children:"A単adir Usuario"})}),s.jsxs(A,{children:[s.jsx(f,{label:"Nombre de Usuario",name:"usuario",value:d.usuario,onChange:w}),s.jsx(f,{label:"Contrase単a",name:"password",type:"password",value:d.password,onChange:w}),s.jsxs(M,{label:"Tipo",name:"tipo",value:d.tipo,onChange:w,children:[s.jsx("option",{value:"",children:"Seleccionar Tipo"}),s.jsx("option",{value:"Administrador",children:"Administrador"}),s.jsx("option",{value:"Editor",children:"Editor"})]})]}),s.jsxs(F,{children:[s.jsx(r,{color:"secondary",onClick:()=>u(!1),children:"Cerrar"}),s.jsx(r,{color:"primary",onClick:G,children:"Guardar"})]})]}),s.jsxs(D,{visible:P,onClose:()=>h(!1),children:[s.jsx(k,{children:s.jsx("h5",{children:"Editar Usuario"})}),s.jsx(A,{children:l&&s.jsxs(s.Fragment,{children:[s.jsx(f,{label:"Nombre de Usuario",name:"usuario",value:l.usuario,onChange:b}),s.jsx(f,{label:"Contrase単a",name:"password",type:"password",value:l.password,onChange:b}),s.jsxs(M,{label:"Tipo",name:"tipo",value:l.tipo,onChange:b,children:[s.jsx("option",{value:"Administrador",children:"Administrador"}),s.jsx("option",{value:"Editor",children:"Editor"})]})]})}),s.jsxs(F,{children:[s.jsx(r,{color:"secondary",onClick:()=>h(!1),children:"Cerrar"}),s.jsx(r,{color:"primary",onClick:L,children:"Guardar Cambios"})]})]})]})};export{ps as default};
